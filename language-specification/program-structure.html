<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Groovy 中文文档</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/groovy-chinese/favicon.ico">
    <script async="true" type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279042755&amp;web_id=1279042755"></script>
    <script async="true" type="text/javascript" src="https://hm.baidu.com/hm.js?c400d319a39a68ea6a3732c9dcd9073d"></script>
    <meta name="description" content="Groovy 中文文档">
    <meta name="keyword" content="groovy,groovy中文,groovy文档,groovy中文网">
    <link rel="preload" href="/groovy-chinese/assets/css/0.styles.9eae98ba.css" as="style"><link rel="preload" href="/groovy-chinese/assets/js/app.b783695b.js" as="script"><link rel="preload" href="/groovy-chinese/assets/js/2.85d751e5.js" as="script"><link rel="preload" href="/groovy-chinese/assets/js/9.bdf2ea71.js" as="script"><link rel="prefetch" href="/groovy-chinese/assets/js/10.c0478869.js"><link rel="prefetch" href="/groovy-chinese/assets/js/11.4b809aba.js"><link rel="prefetch" href="/groovy-chinese/assets/js/3.6ad61dca.js"><link rel="prefetch" href="/groovy-chinese/assets/js/4.a8f87cbb.js"><link rel="prefetch" href="/groovy-chinese/assets/js/5.800cdb70.js"><link rel="prefetch" href="/groovy-chinese/assets/js/6.15b86ed3.js"><link rel="prefetch" href="/groovy-chinese/assets/js/7.0ea781c0.js"><link rel="prefetch" href="/groovy-chinese/assets/js/8.7d3fe0f9.js">
    <link rel="stylesheet" href="/groovy-chinese/assets/css/0.styles.9eae98ba.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/groovy-chinese/" class="home-link router-link-active"><!----> <span class="site-name">Groovy 中文文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/groovy-chinese/getting-started/download-groovy.html" class="nav-link">
  快速开始
</a></div><div class="nav-item"><a href="/groovy-chinese/language-specification/syntax.html" class="nav-link">
  文档
</a></div> <a href="https://github.com/juzi214032/groovy-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/groovy-chinese/getting-started/download-groovy.html" class="nav-link">
  快速开始
</a></div><div class="nav-item"><a href="/groovy-chinese/language-specification/syntax.html" class="nav-link">
  文档
</a></div> <a href="https://github.com/juzi214032/groovy-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/groovy-chinese/language-specification/syntax.html" class="sidebar-link">语法</a></li><li><a href="/groovy-chinese/language-specification/operators.html" class="sidebar-link">运算符</a></li><li><a href="/groovy-chinese/language-specification/program-structure.html" aria-current="page" class="active sidebar-link">程序结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/groovy-chinese/language-specification/program-structure.html#_1-包名" class="sidebar-link">1. 包名</a></li><li class="sidebar-sub-header"><a href="/groovy-chinese/language-specification/program-structure.html#_2-导入" class="sidebar-link">2. 导入</a></li><li class="sidebar-sub-header"><a href="/groovy-chinese/language-specification/program-structure.html#_3-脚本与类" class="sidebar-link">3. 脚本与类</a></li></ul></li><li><a href="/groovy-chinese/language-specification/object-orientation.html" class="sidebar-link">面向对象</a></li><li><a href="/groovy-chinese/unfinished.html" class="sidebar-link">闭包</a></li><li><a href="/groovy-chinese/unfinished.html" class="sidebar-link">语义</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>本章将会介绍 Groovy 的程序结构</p> <h2 id="_1-包名"><a href="#_1-包名" class="header-anchor">#</a> 1. 包名</h2> <p>包名的作用与 Java 中的作用完全相同。它们使我们能够在没有任何冲突的情况下分离代码库。Groovy 类必须在类定义之前指定它们的包，否则就采用默认的包。</p> <p>定义包名和 Java 中非常相似：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// 定义一个名为 com.yoursite 的包</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>yoursite
</code></pre></div><p>要引用<code>com.yoursite.com</code>包中的某个类<code>Foo</code>，你需要使用完全限定的名称<code>com.yoursite.com.Foo</code>，或者你可以使用导入语句，我们将在下面看到。</p> <h2 id="_2-导入"><a href="#_2-导入" class="header-anchor">#</a> 2. 导入</h2> <p>为了引用任何一个类，你需要对它的包进行限定引用。Groovy 遵循 Java 的概念，允许使用导入语句来解析类引用。</p> <p>例如，Groovy 提供了几个构建类，比如<code>MarkupBuilder</code>。<code>MarkupBuilder</code>在包<code>groovy.xml</code>里面，所以为了使用这个类，你需要导入它，如下所示：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// 导入 MarkupBuilder 类</span>
<span class="token keyword">import</span> groovy<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>MarkupBuilder

<span class="token comment">// 使用导入的类创建一个对象</span>
<span class="token keyword">def</span> xml <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> xml <span class="token operator">!=</span> null
</code></pre></div><h3 id="_2-1-默认导入"><a href="#_2-1-默认导入" class="header-anchor">#</a> 2.1 默认导入</h3> <p>默认导入是指Groovy语言默认提供的导入。例如下面的代码：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>同样的代码在 Java 中需要向<code>Date</code>类导入语句，比如：import java.util.Date。Groovy 默认会帮你导入这些类。</p> <p>以下是由 groovy 为你默认导入的包：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>*
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>*
<span class="token keyword">import</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>*
<span class="token keyword">import</span> groovy<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>*
<span class="token keyword">import</span> groovy<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*
<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger
<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigDecimal
</code></pre></div><p>这样做是因为这些包中的类是最常用的。通过默认导入这些包去减少重复的代码。</p> <h3 id="_2-2-简单导入"><a href="#_2-2-简单导入" class="header-anchor">#</a> 2.2 简单导入</h3> <p>简单导入是指在导入语句中，将类名与包名一起完整定义。例如下面代码中的导入语句 import groovy.xml.MarkupBuilder 就是一个简单的导入，它直接引用一个包内的类。</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// 导入 MarkupBuilder 类</span>
<span class="token keyword">import</span> groovy<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>MarkupBuilder

<span class="token comment">// 使用导入的类创建一个对象</span>
<span class="token keyword">def</span> xml <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> xml <span class="token operator">!=</span> null
</code></pre></div><h3 id="_2-3-星号导入"><a href="#_2-3-星号导入" class="header-anchor">#</a> 2.3 星号导入</h3> <p>Groovy和Java一样，提供了一种特殊的方式来使用<code>*</code>从一个包中导入所有的类，即所谓的星号导入。<code>MarkupBuilder</code>是一个类，它在包<code>groovy.xml</code>中，与另一个类<code>StreamingMarkupBuilder</code>一起。如果你需要使用这两个类，你可以这样做：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> groovy<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>MarkupBuilder
<span class="token keyword">import</span> groovy<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>StreamingMarkupBuilder

<span class="token keyword">def</span> markupBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> markupBuilder <span class="token operator">!=</span> null

<span class="token keyword">assert</span> <span class="token keyword">new</span> <span class="token class-name">StreamingMarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null
</code></pre></div><p>这是完全有效的代码。但是通过<code>*</code>的导入，我们只需要一行就可以达到同样的效果。star导入了<code>groovy.xml</code>包下的所有类：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> groovy<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>*

<span class="token keyword">def</span> markupBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> markupBuilder <span class="token operator">!=</span> null

<span class="token keyword">assert</span> <span class="token keyword">new</span> <span class="token class-name">StreamingMarkupBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null
</code></pre></div><p>星号导入的一个问题是，它们会使你的本地命名空间混乱。但如果使用 Groovy 提供的别名，这个问题就可以轻松解决。</p> <h3 id="_2-4-静态导入"><a href="#_2-4-静态导入" class="header-anchor">#</a> 2.4 静态导入</h3> <p>Groovy 的静态导入功能允许你引用导入的类，就像在自己的类中引用静态方法一样：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> <span class="token keyword">static</span> Boolean<span class="token punctuation">.</span>FALSE

<span class="token keyword">assert</span> <span class="token operator">!</span>FALSE <span class="token comment">//use directly, without Boolean prefix!</span>
</code></pre></div><p>这类似于 Java 的静态导入功能，但比 Java 更动态，只要你的类型不同，就可以定义与导入方法同名的方法：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> <span class="token keyword">static</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>String<span class="token punctuation">.</span>format <span class="token comment">// 注释 1</span>

<span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>

    String <span class="token function">format</span><span class="token punctuation">(</span>Integer i<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 注释 2</span>
        i<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'String'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'String'</span> <span class="token comment">// 注释 3</span>
        <span class="token keyword">assert</span> <span class="token keyword">new</span> <span class="token class-name">SomeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>注释 1：静态导入方法</p></li> <li><p>注释 2：声明方法的名称与上面静态导入的方法相同，但参数类型不同。</p></li> <li><p>注释 3：在 Java 中会编译错误，但在 Groovy 中是正确的</p> <p>如果类型相同，导入的类优先级更高。</p></li></ul> <h3 id="_2-5-静态导入别名"><a href="#_2-5-静态导入别名" class="header-anchor">#</a> 2.5 静态导入别名</h3> <p>使用<code>as</code>关键字的静态导入为命名空间问题提供了一个优雅的解决方案。假设你想获得一个<code>Calendar</code>实例，使用它的<code>getInstance()</code>方法，这是一个静态方法，所以我们可以使用静态导入。当与它的类名分开时，会产生歧义，我们可以使用别名导入，而不是每次都调用<code>getInstance()</code>，这样可以增加代码的可读性：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> <span class="token keyword">static</span> Calendar<span class="token punctuation">.</span>getInstance <span class="token keyword">as</span> now

<span class="token keyword">assert</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">==</span> Calendar<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">class</span>
</code></pre></div><p>现在它清爽多了！</p> <h3 id="_2-6-静态星号导入"><a href="#_2-6-静态星号导入" class="header-anchor">#</a> 2.6 静态星号导入</h3> <p>静态星号导入与常规星号导入非常相似。它将导入给定类的所有静态方法。</p> <p>例如，假设我们需要为我们的应用程序计算正弦和余弦。<code>java.lang.Math</code>类中有名为<code>sin</code>和<code>cos</code>的静态方法，它们符合我们的需求。在静态星号导入的帮助下，我们可以这样做：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> <span class="token keyword">static</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Math<span class="token punctuation">.</span>*

<span class="token keyword">assert</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.0</span>
<span class="token keyword">assert</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1.0</span>
</code></pre></div><p>如你所见，我们能够直接访问方法<code>sin</code>和<code>cos</code>，而无需<code>Math.</code>前缀。</p> <h3 id="_2-7-别名导入"><a href="#_2-7-别名导入" class="header-anchor">#</a> 2.7 别名导入</h3> <p>通过类型别名，我们可以使用我们选择的名称来引用一个完全限定的类名。这可以通过<code>as</code>关键字来实现，就像前面一样。</p> <p>例如，我们可以将<code>java.sql.Date</code>导入为<code>SQLDate</code>，并将其与<code>java.util.Date</code>在同一个文件中使用，而不必使用任何一个类的完全限定名。</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Date <span class="token keyword">as</span> SQLDate

Date utilDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1000L</span><span class="token punctuation">)</span>
SQLDate sqlDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SQLDate</span><span class="token punctuation">(</span><span class="token number">1000L</span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> utilDate <span class="token keyword">instanceof</span> <span class="token class-name">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date</span>
<span class="token keyword">assert</span> sqlDate <span class="token keyword">instanceof</span> <span class="token class-name">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Date</span>
</code></pre></div><h2 id="_3-脚本与类"><a href="#_3-脚本与类" class="header-anchor">#</a> 3. 脚本与类</h2> <h3 id="_3-1-public-static-void-main-与-script"><a href="#_3-1-public-static-void-main-与-script" class="header-anchor">#</a> 3.1 public static void main 与 script</h3> <p>Groovy 同时支持脚本和类。以下面的代码为例：</p> <p>Main.groovy</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>                                    <span class="token comment">// 注释 1</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">...</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">// 注释 2</span>
        println <span class="token string">'Groovy world!'</span>                 <span class="token comment">// 注释 3</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>注释 1：定义一个<code>Main</code>类，名称是任意的。</li> <li>注释 2：<code>public static void main(String[])</code>方法可以作为类的主方法使用</li> <li>注释 3：main 的方法体</li></ul> <p>这是典型的来自 Java 的代码，代码必须嵌入到一个类中才能执行。Groovy 让它变得更简单，下面的代码含义与上面相同：</p> <p>Main.groovy</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>println <span class="token string">'Groovy world!'</span>
</code></pre></div><p>脚本可以看作是一个类，而不需要声明它，这是脚本与类的一部分区别。</p> <h3 id="_3-2-脚本类"><a href="#_3-2-脚本类" class="header-anchor">#</a> 3.2 脚本类</h3> <p>脚本总是被编译成一个类。Groovy 编译器将为你编译这个类，并将脚本的主体复制到一个运行方法中。因此，前面的例子被编译成了下面的样子：</p> <p>Main.groovy</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>InvokerHelper
<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">Script</span> <span class="token punctuation">{</span>                     <span class="token comment">// 注释 1</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                 <span class="token comment">// 注释 2</span>
        println <span class="token string">'Groovy world!'</span>                 <span class="token comment">// 注释 3</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token comment">// 注释 4</span>
        InvokerHelper<span class="token punctuation">.</span><span class="token function">runScript</span><span class="token punctuation">(</span>Main<span class="token punctuation">,</span> args<span class="token punctuation">)</span>     <span class="token comment">// 注释 5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>注释 1：<code>Main</code>类继承自<code>groovy.lang.Script</code>类</li> <li>注释 2：<code>groovy.lang.Script</code>需要一个有返回值的<code>run</code>方法。</li> <li>注释 3：脚本主体在<code>run</code>方法内</li> <li>注释 4：<code>main</code>方法会自动生成</li> <li>注释 5：委托<code>run</code>方法执行脚本。</li></ul> <p>如果脚本在一个文件中，那么文件的基本名称将被用来确定生成的脚本类的名称。在这个例子中，如果文件的名字是<code>Main.groovy</code>，那么脚本类将是<code>Main</code>。</p> <h3 id="_3-3-方法"><a href="#_3-3-方法" class="header-anchor">#</a> 3.3 方法</h3> <p>可以在脚本中定义方法，如图所示：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">int</span> <span class="token function">fib</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    n <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token function">fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fib</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">assert</span> <span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">89</span>
</code></pre></div><p>你也可以将方法和代码混合在一起。生成的脚本类会将所有方法带入脚本类，并将所有脚本体组装到运行方法中：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>println <span class="token string">'Hello'</span>                                 <span class="token comment">// 注释 1</span>

<span class="token keyword">int</span> <span class="token function">power</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token operator">**</span>n <span class="token punctuation">}</span>                       <span class="token comment">// 注释 2</span>

println <span class="token string gstring">&quot;2^6==<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token function">power</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>&quot;</span>                      <span class="token comment">// 注释 3</span>
</code></pre></div><ul><li>注释 1：脚本开始</li> <li>注释 2：一个方法定义在脚本主体重</li> <li>注释 3：脚本继续</li></ul> <p>此代码在内部转换为：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">import</span> org<span class="token punctuation">.</span>codehaus<span class="token punctuation">.</span>groovy<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>InvokerHelper
<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">Script</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">power</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token operator">**</span> n<span class="token punctuation">}</span>                   <span class="token comment">// 注释 1</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        println <span class="token string">'Hello'</span>                         <span class="token comment">// 注释 2</span>
        println <span class="token string gstring">&quot;2^6==<span class="token expression"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token function">power</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>&quot;</span>              <span class="token comment">// 注释 3</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        InvokerHelper<span class="token punctuation">.</span><span class="token function">runScript</span><span class="token punctuation">(</span>Main<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>注释 1：<code>power</code>方法被原样复制到生成的脚本类中</li> <li>注释 2：第一条语句被复制到运行方法中</li> <li>注释 3：第二条语句被复制到运行方法中</li></ul> <p>即使 Groovy 从你的脚本中创建一个类，对用户来说也是完全透明的。特别是，脚本会被编译成字节码，并且保留了行号。这意味着，如果在脚本中抛出异常，堆栈跟踪将显示对应于原始脚本的行号，而不是我们显示的生成代码。</p> <h3 id="_3-4-变量"><a href="#_3-4-变量" class="header-anchor">#</a> 3.4 变量</h3> <p>脚本中的变量不需要类型定义。这意味着这个脚本：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">assert</span> x<span class="token operator">+</span>y <span class="token operator">==</span> <span class="token number">3</span>
</code></pre></div><p>将表现为：</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>x <span class="token operator">=</span> <span class="token number">1</span>
y <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">assert</span> x<span class="token operator">+</span>y <span class="token operator">==</span> <span class="token number">3</span>
</code></pre></div><p>然而两者在语义上是有区别的：</p> <ul><li>如果变量的声明和第一个例子一样，那么它就是一个局部变量。它将在编译器生成的<code>run</code>方法中声明，在脚本主体之外将不可见。特别要注意：这样的变量在脚本的其他方法中是不可见的。</li> <li>如果变量未声明，它就会进入脚本绑定中。绑定在方法中是可见的，如果你使用脚本与应用程序交互，并且需要在脚本和应用程序之间共享数据，那么绑定就显得尤为重要。读者可以参考集成指南了解更多信息。</li></ul> <p>如果你想让一个变量在不进入<code>Binding</code>的情况下成为类的一个字段，你可以使用<code>@Field</code>注解。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/juzi214032/groovy-chinese/edit/master/docs/language-specification/program-structure.md" target="_blank" rel="noopener noreferrer">纠正错误</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/groovy-chinese/language-specification/operators.html" class="prev">
        运算符
      </a></span> <span class="next"><a href="/groovy-chinese/language-specification/object-orientation.html">
        面向对象
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div></div></div>
    <script src="/groovy-chinese/assets/js/app.b783695b.js" defer></script><script src="/groovy-chinese/assets/js/2.85d751e5.js" defer></script><script src="/groovy-chinese/assets/js/9.bdf2ea71.js" defer></script>
  </body>
</html>
